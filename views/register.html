<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  </head>
  <body
    class="bg-gray-900 flex justify-center items-center h-screen text-white"
  >
    <div class="p-6 bg-gray-800 rounded-xl shadow-lg w-80">
      <h1 class="text-2xl font-bold mb-4">Register</h1>

      <input
        id="username"
        class="w-full p-2 rounded mb-3 bg-gray-700"
        placeholder="Username"
      />
      <input
        id="email"
        class="w-full p-2 rounded mb-3 bg-gray-700"
        placeholder="Email"
      />
      <input
        id="password"
        type="password"
        class="w-full p-2 rounded mb-3 bg-gray-700"
        placeholder="Password"
      />

      <!-- Role Selection -->
      <select id="role" class="w-full p-2 rounded mb-3 bg-gray-700">
        <option value="user" selected>User</option>
        <option value="admin">Admin</option>
      </select>

      <button
        onclick="registerUser()"
        class="w-full bg-green-500 p-2 rounded hover:bg-green-600"
      >
        Register
      </button>

      <!-- Message Box -->
      <p id="statusMsg" class="mt-4 text-center font-semibold hidden"></p>

      <p class="mt-3 text-gray-400 text-sm text-center">
        Already have an account?
        <a href="/login" class="text-blue-400">Login</a>
      </p>
    </div>

    <script>
      async function registerUser() {
        const statusBox = document.getElementById("statusMsg");
        statusBox.classList.add("hidden");

        const res = await fetch("/api/auth/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            username: document.getElementById("username").value,
            email: document.getElementById("email").value,
            password: document.getElementById("password").value,
            role: document.getElementById("role").value,
          }),
        });

        const data = await res.json();

        statusBox.textContent = data.message;
        statusBox.classList.remove("hidden");

        if (data.success) {
          statusBox.className = "mt-4 text-green-400 text-center font-semibold";

          // Redirect after 3 seconds
          setTimeout(() => {
            window.location.href = "/login";
          }, 3000);
        } else {
          statusBox.className = "mt-4 text-red-400 text-center font-semibold";
        }
      }
    </script>
  </body>
</html>
